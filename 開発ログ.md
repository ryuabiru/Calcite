# プロジェクト「Calcite」開発ログ (2025/08/20更新)

## 1. このプロジェクトで実装したいこと

-   **直感的な操作性**: `Mito`や`GraphPad Prism`のように、プログラミング知識がなくてもGUI操作だけでデータハンドリング、統計解析、グラフ作成が完結するアプリケーションを目指す。
-   **統合環境**: データのインポート、表計算、統計解析、グラフ描画、結果のエクスポートといった一連のワークフローを、シームレスに一つのウィンドウで提供する。
-   **論文品質のグラフ**: ユーザーがタイトル、ラベル、色、エラーバーなどを自由に編集でき、学術論文やプレゼンテーションにそのまま利用できる高品質なグラフを作成できる機能。

---

## 2. これまでに実装してきたこと

-   **基本アーキテクチャ**
    -   `PySide6`をベースとしたGUIアプリケーションの構築。
    -   メンテナンス性を考慮したファイル分割（`main`, `main_window`, `pandas_model`, `graph_widget`, `properties_widget`など）。
    -   **高DPI対応**: `main.py`と`graph_widget.py`を修正し、高解像度ディスプレイでもグラフやUIが鮮明に表示されるように改善。

-   **データハンドリング機能**
    -   **CSVファイルのインポート**: メニューバーからCSVを読み込み、`Pandas`データフレームとして内部で保持。
    -   **クリップボードからのペースト**: Excelなどからコピーしたタブ区切りデータをアプリケーションに直接貼り付ける機能を追加 (`Edit` > `Paste`)。
    -   **テーブル表示とインタラクティブ編集**:
        -   `QTableView`を用いたスプレッドシート形式での表示、セルやカラムヘッダーの直接編集機能。
        -   右クリックメニューからの行・列の追加、削除機能。
    -   **データ変換**:
        -   **ワイドからロングへ**: `pandas.melt`を基盤としたGUIツールで、データをTidy Data形式に再構成する機能。
        -   **数式による列作成**: `pandas.eval`を基盤とし、「`'ColumnA' * 100`」のような数式で新しい列を動的に作成する機能。

-   **グラフ描画・編集機能**
    -   **描画エンジン**: プロパティパネルからY軸(値), X軸(グループ), サブグループを指定するTidy Dataベースの柔軟な方式。
    -   **グラフタイプ**: ツールバーから**散布図**と**棒グラフ**（エラーバー、個別データ点の重ね描き対応）を動的に切り替え。
    -   **プロパティパネル**:
        -   スクロール可能なパネルにUIを集約し、グラフの**タイトル**と**X/Y軸ラベル**をリアルタイムで更新。
        -   散布図の**マーカーの種類**、**単一色**および**サブグループごと**の色をカラーピッカーで個別に設定。
    -   **描画の維持**: グラフのプロパティ更新時に、描画した回帰直線やフィッティング曲線が消えないようにロジックを改善。

-   **統計解析機能 (v2)**
    -   **独立t検定**: 選択した2列のデータでt検定を実行。
    -   **一元配置分散分析 (ANOVA)**: 3群以上の比較に対応。
        -   **Tukey's HSD検定**: ANOVAで有意差があった場合に、どの群間に差があるかを特定する多重比較検定（ポストホックテスト）を追加。
    -   **線形回帰分析**: 散布図にフィットラインを描画し、凡例に**R²値**を表示。
    -   **非線形回帰分析**: 散布図データに対し、**シグモイド曲線（4パラメータロジスティックモデル）**のフィッティングを実行し、EC50などのパラメータを算出する機能を追加。
    -   **結果表示**: 解析結果をコピー可能な専用ダイアログで表示するように改善。

-   **エクスポート機能**
    -   作成したグラフを**PNG, JPEG, SVG, PDF**形式で、300 DPIの高解像度で保存する機能を追加 (`File` > `Save Graph As...`)。

---

## 3. これからの実装予定

-   **グラフ編集機能のさらなる強化**
    -   グラフの**軸の範囲**（X/Yのmin, max）をGUIで編集する機能。
    -   プロパティパネルに、**線のスタイル**（実線、破線など）や**太さ**を変更するコントロールを追加。
    -   統計解析結果（例: p値、有意差を示すアスタリスク）をグラフ上にアノテーションとして表示する機能。

-   **データハンドリング機能の強化**
    -   **フィルタリング**: 特定の条件（例: `Value > 10`）で表示するデータを絞り込むUI機能。
    -   **ソート**: 列ヘッダーのクリックでデータを並び替える機能。

-   **エクスポート機能の強化**
    -   表示されているテーブルデータをCSV形式で保存する機能。

---

素晴らしいペースで開発が進んでいますね！基本的なワークフローが完成し、非常に実践的なツールになりました。
ゆっくり休んで、また次の実装でお会いできるのを楽しみにしています！