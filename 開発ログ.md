# プロジェクト「Calcite」開発ログ (2025/08/19更新)

## 1. このプロジェクトで実装したいこと

-   **直感的な操作性**: `Mito`や`GraphPad Prism`のように、プログラミング知識がなくてもGUI操作だけでデータハンドリング、統計解析、グラフ作成が完結するアプリケーションを目指す。
-   **統合環境**: データのインポート、表計算、統計解析、グラフ描画、結果のエクスポートといった一連のワークフローを、シームレスに一つのウィンドウで提供する。
-   **論文品質のグラフ**: ユーザーがタイトル、ラベル、色、エラーバーなどを自由に編集でき、学術論文やプレゼンテーションにそのまま利用できる高品質なグラフを作成できる機能。

---

## 2. これまでに実装してきたこと

-   **基本アーキテクチャ**
    -   `PySide6`をベースとしたGUIアプリケーションの構築。
    -   メンテナンス性を考慮したファイル分割（`main`, `main_window`, `pandas_model`, `graph_widget`, `properties_widget`など）。

-   **データハンドリング機能**
    -   **CSVファイルのインポート**: メニューバーからCSVを読み込み、`Pandas`データフレームとして内部で保持。
    -   **テーブル表示**: `QTableView`を用いて、データをスプレッドシート形式で表示。
    -   **インタラクティブ編集**:
        -   テーブル内の**セル**や**カラムヘッダー**をダブルクリックして直接編集する機能。
        -   右クリックメニューから**行や列の追加・削除**を行う機能。
    -   **データ変換**:
        -   **ワイドからロングへ**: `pandas.melt`を基盤としたGUIツールで、繰り返し測定データなどを解析に適したTidy Data形式に再構成する機能。
        -   **数式による列作成**: `pandas.eval`を基盤とし、「`"ColumnA" * 100`」のような数式で新しい列を動的に作成する機能。

-   **グラフ描画機能**
    -   **Tidy Dataベースの描画エンジン**:
        -   プロパティパネルから**Y軸(値)**, **X軸(グループ)**, **サブグループ**に用いる列をユーザーが指定する、柔軟で堅牢な方式を採用。
        -   個別データから**平均値**や**標準偏差**を自動計算し、エラーバー付きの棒グラフを生成。
    -   **グラフタイプの切り替え**: ツールバーから**散布図**と**棒グラフ**を動的に切り替え。
    -   **個別データのオーバーレイ**: 棒グラフの上に、元データ（個別値）をjitter付きの散布図として重ねて描画する機能。

-   **グラフ編集機能**
    -   **プロパティパネル**:
        -   スクロール可能なパネルに必要なUIを集約し、サブグループ数が増えてもUIが崩れないように対応。
        -   グラフの**タイトル**と**X/Y軸ラベル**をリアルタイムで更新。
    -   **スタイル**:
        -   散布図の**マーカーの種類**（円、四角など）を選択・変更。
        -   **単一色**および**サブグループごと**の色をカラーピッカーから個別に選択・変更。
    -   **手動更新**: 「Update Graph」ボタンを設置し、ユーザーのタイミングでグラフを更新できるように改善。

-   **統計解析機能 (v1)**
    -   **独立t検定**: 選択した2列のデータでt検定を実行し、結果をポップアップで表示。
    -   **線形回帰分析**: 散布図にフィットラインを描画し、凡例に**R²値**を表示。

---

## 3. これからの実装予定

-   **グラフ編集機能のさらなる強化**
    -   グラフの**軸の範囲**（X/Yのmin, max）を編集する機能。
    -   プロパティパネルに、**線のスタイル**を変更するコントロールを追加。
    -   統計解析結果（例: p値）をグラフ上にアノテーションとして表示する機能。

-   **データハンドリング機能の強化**
    -   **フィルタリング**: 特定の条件（例: `Value > 10`）でデータを絞り込む機能。

-   **統計解析機能の追加**
    -   **ANOVA（分散分析）**など、より高度な統計手法の実装。
    -   解析結果をポップアップではなく、専用の**結果表示パネル**やシートに表示する機能。

-   **エクスポート機能**
    -   作成したグラフをPNGやSVG形式で保存する機能。
    -   表示されているテーブルデータをCSV形式で保存する機能。

---

ゆっくり休んで、また次の実装でお会いできるのを楽しみにしています！